<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
<web>Main</web>
<name>Dashboard</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>Main.WebHome</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1252458000000</creationDate>
<date>1288648433000</date>
<contentUpdateDate>1288648433000</contentUpdateDate>
<version>1.1</version>
<title>$msg.get("xe.dashboard.wiki")</title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.0</syntaxId>
<hidden>false</hidden>
<object>
<class>
<name>XWiki.StyleSheetExtension</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<cache>
<cache>0</cache>
<disabled>0</disabled>
<displayType>select</displayType>
<multiSelect>0</multiSelect>
<name>cache</name>
<number>5</number>
<prettyName>Caching policy</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>1</size>
<unmodifiable>0</unmodifiable>
<values>long|short|default|forbid</values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</cache>
<code>
<disabled>0</disabled>
<name>code</name>
<number>2</number>
<prettyName>Code</prettyName>
<rows>20</rows>
<size>50</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</code>
<name>
<disabled>0</disabled>
<name>name</name>
<number>1</number>
<prettyName>Name</prettyName>
<size>30</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
</name>
<parse>
<disabled>0</disabled>
<displayFormType>select</displayFormType>
<displayType>yesno</displayType>
<name>parse</name>
<number>4</number>
<prettyName>Parse content</prettyName>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
</parse>
<use>
<cache>0</cache>
<disabled>0</disabled>
<displayType>select</displayType>
<multiSelect>0</multiSelect>
<name>use</name>
<number>3</number>
<prettyName>Use this extension</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>1</size>
<unmodifiable>0</unmodifiable>
<values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</use>
</class>
<name>Main.Dashboard</name>
<number>0</number>
<className>XWiki.StyleSheetExtension</className>
<guid>384eebef-65ee-4d21-8fa7-af59b3b62047</guid>
<property>
<cache>default</cache>
</property>
<property>
<code>div.dashboardleft {
  float:left; 
  width: 44.9%;
}

div.dashboardleft div.dashboardleftcontent {
  padding-right:20px;
}

div.dashboardright {
  float:left; 
  width: 55.1%;
}

div.dashboardright div.dashboardrightcontent {
  padding-left: 20px;
}

div.dashboardspacer {
  clear:both; 
  margin-bottom:40px;
}</code>
</property>
<property>
<name></name>
</property>
<property>
<parse>0</parse>
</property>
<property>
<use>onDemand</use>
</property>
</object>
<content>{{velocity wiki="true"}}
    ##
    ## XWiki Dashboard
    ##
    ## This dashboard can be used for both wikis (Main.WebHome)
    ## and spaces (*.WebHome).
    ##
    $xwiki.ssx.use('Main.Dashboard')##
    #set ($isSpaceDashboard = false)
    #if ($doc.space != "Main")
      #set ($isSpaceDashboard = true)
    #end
    (% class="dashboard" %)
    (((
      (% class="dashboardleft" %)
      (((
        ##
        ## Left column.
        ##
        (% class="dashboardleftcontent" %)
        (((
          #if (!$isSpaceDashboard)
            ##
            ## Wiki spaces and tags
            ##
            = $msg.get("xe.dashboard.wiki.spaces") =

            {{spaces /}}

            = $msg.get("xe.dashboard.wiki.tagcloud") =

            {{tagcloud /}}

          #else
            ##
            ## Space documents and tags
            ##
            = $msg.get("xe.dashboard.space.documents", [$doc.space]) =

            #set($limit = 100)## Maximum number of documents we display in the space dashboard list
            #set($docNames = $xwiki.searchDocuments("where doc.space='${doc.space}' order by doc.creationDate desc", $limit, 0))
            {{html}}
              #displayDocumentList($docNames false []) 
              ## Note: we pass an empty blacklistedSpaces list since we are used as a space dashboard, not a global dashboard
            {{/html}}

            #if($docNames.size() == $limit)
              #set($docCount = $xwiki.countDocuments("where doc.space='${doc.space}'"))
              #set($remaining = $mathtool.sub($docCount, $limit))
              #if($remaining &gt; 0)
              (% class="documentListMore" %) (((
              // $msg.get('xe.dashboard.space.remainingDocumentsInSpace', [$remaining, $doc.space])
                 [[$msg.get('xe.dashboard.space.visitSpaceIndex')&gt;&gt;Main.SpaceIndex?space=$doc.space]] //
              )))
              #end
            #end
            = $msg.get("xe.dashboard.wiki.tagcloud") =
            #set ($tagCloudSpace = $doc.space)

            {{tagcloud  space="$tagCloudSpace" /}}

          #end
        )))
      )))
      (% class="dashboardright" %)
      (((
        ##
        ## Right column
        ##
        (% class="dashboardrightcontent" %)
        (((
          ##
          ## Recent activity
          ##
          ## reset the two variables to make sure that whatever was on the context, the correct values are sent on both the cases possible here
          #set($rcSpace = $util.null)
          #set($rcChangesNb = $util.null)
          #if (!$isSpaceDashboard)
            = $msg.get("xe.dashboard.wiki.recentactivity") =
          #else
            = $msg.get("xe.dashboard.space.recentactivity", [$doc.space]) =
            ## Set variables to limit recent activity to the current space and 15 items.
            #set ($rcSpace = $doc.space)
            #set ($rcChangesNb = 15)
          #end

          {{recentactivity space="$!rcSpace" changesNb="$!rcChangesNb" /}}

        )))
      )))
      (% class="dashboardspacer" %)
      (((~ )))
    )))
{{/velocity}}</content>
</xwikidoc>
