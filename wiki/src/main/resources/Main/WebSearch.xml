<?xml version="1.0" encoding="ISO-8859-1"?>

<xwikidoc>
<web>Main</web>
<name>WebSearch</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent>Main.WebHome</parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1107744420000</creationDate>
<date>1184488764000</date>
<contentUpdateDate>1184488764000</contentUpdateDate>
<version>1.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<content>1 $msg.get("search")

#if(!$request.space)
  #set($space = 'All')
#else
  #set($space = $request.space)
#end

#set($spacesText = {})
#set($spaces = $xwiki.spaces)
#set($ok = $spacesText.put('All','All'))
#foreach($space in $spaces)
  #set($ok = $spacesText.put($space,$space))
#end

#macro(spaceoption $space $selectspace $spacesText)
  &lt;option value="$spacesText.get($space)" #if($selectspace == $spacesText.get($space))selected="selected"#end&gt;$space&lt;/option&gt;
#end

#macro(spaceselect $selectspace $spaces $spacesText)
  &lt;select name="space"&gt;
    #spaceoption("All" $selectspace $spacesText)
    #foreach($space in $spaces)
      #spaceoption($space $selectspace $spacesText)
    #end
  &lt;/select&gt;
#end
##
##
#set($text = "$!request.getParameter('text')")
#set($utext = $util.encodeURI($text))
#if($space == "All")
  #set($url = $xwiki.getURL('Main.WebSearchRss', 'view', "xpage=plain&amp;amp;text=${utext}" ))
#else
  #set($url = $xwiki.getURL('Main.WebSearchRss', 'view', "xpage=plain&amp;space=$space&amp;text=${utext}"))
#end

&lt;div style="float: right;"&gt;
  &lt;a href="$url"&gt;&lt;img src="$xwiki.getSkinFile("icons/black-rss.png")" style="border:0px" alt="$msg.get('xe.rss.icon')" /&gt;&lt;/a&gt;
&lt;/div&gt;

&lt;form action=""&gt;
  {pre}
    &lt;div class="centered"&gt;
      $msg.get('xe.search.query')
      &lt;input type="text" name="text" value="$xwiki.getFormEncoded($!text)" size="20"/&gt;
      $msg.get('xe.search.in.space') #spaceselect($space $spaces $spacesText) &lt;input type="submit" value="$msg.get('xe.search.go')"/&gt;
    &lt;/div&gt;
  {/pre}
&lt;/form&gt;

#includeInContext("XWiki.WebSearchCode")
#includeInContext("XWiki.Results")

#set($luceneSearch = "[$msg.get('xe.search.lucene')&gt;Main.LuceneSearch?text=$!utext]")
#info($msg.get('xe.search.lucene.try', [$luceneSearch]))
</content></xwikidoc>